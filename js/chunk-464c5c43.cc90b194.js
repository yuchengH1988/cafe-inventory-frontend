(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-464c5c43"],{"1c7b":function(t,e,n){"use strict";n("6745")},4680:function(t,e,n){"use strict";n("a764")},5158:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"link-wrapper d-flex ml-3"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data/ingredients"}},[t._v("Ingredients")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data/products"}},[t._v("Products")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data/composition"}},[t._v("Conposition")])],1)])},r=[],a=(n("1c7b"),n("2877")),s={},c=Object(a["a"])(s,i,r,!1,null,"19a7bc4c",null);e["a"]=c.exports},6745:function(t,e,n){},"7db0":function(t,e,n){"use strict";var i=n("23e7"),r=n("b727").find,a=n("44d2"),s="find",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),i({target:"Array",proto:!0,forced:c},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a(s)},a764:function(t,e,n){},aa93:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container py-5"},[n("div",{staticClass:"nav-wrapper d-flex"},[n("AdminTab"),n("DataTab")],1),t.isLoading?n("Spinner"):[n("div",{staticClass:"products-main mt-3 d-flex align-items-start"},[n("div",{staticClass:"products-wrapper card"},[n("span",{staticClass:"product-title"},[t._v("Products List")]),t._l(t.products,(function(e){return n("div",{key:e.id,staticClass:"product-list d-flex align-items-center"},[n("span",[t._v(t._s(e.name))]),n("button",{staticClass:"btn btn-info btn-sm ml-auto",attrs:{type:"button"},on:{click:function(n){return t.editInput(e._id)}}},[t._v(" Edit ")])])})),n("button",{staticClass:"btn btn-info btn-sm mx-5 mt-3",attrs:{type:"button"},on:{click:function(e){t.resetEditData(),t.editInput()}}},[t._v(" New ")])],2),t.isEditing?n("div",{staticClass:"product-form ml-5 card"},[n("span",{staticClass:"form-title mb-2"},[t._v(t._s(t.editProduct.name?t.editProduct.name:"New Ingredient"))]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editProduct.name,expression:"editProduct.name"}],staticClass:"form-control form-input",attrs:{type:"text"},domProps:{value:t.editProduct.name},on:{input:function(e){e.target.composing||t.$set(t.editProduct,"name",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("Size")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editProduct.size,expression:"editProduct.size"}],staticClass:"form-control form-input",attrs:{type:"text"},domProps:{value:t.editProduct.size},on:{input:function(e){e.target.composing||t.$set(t.editProduct,"size",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("Price")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editProduct.price,expression:"editProduct.price"}],staticClass:"form-control form-input",attrs:{type:"number"},domProps:{value:t.editProduct.price},on:{input:function(e){e.target.composing||t.$set(t.editProduct,"price",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper justify-content-between"},[n("button",{staticClass:"btn btn-info",attrs:{disabled:t.isProcessing},on:{click:t.updateProduct}},[t._v(" "+t._s(t.isProcessing?"Processing":"Save")+" ")]),n("button",{staticClass:"btn btn-warning",on:{click:t.cancelEdit}},[t._v("Cancel")]),t.editProduct._id?n("button",{staticClass:"btn btn-danger",attrs:{disabled:t.isProcessing},on:{click:t.deleteProduct}},[t._v(" "+t._s(t.isProcessing?"Processing":"Delete")+" ")]):t._e()])]):t._e()])]],2)},r=[],a=n("5530"),s=n("1da1"),c=(n("7db0"),n("b0c0"),n("96cf"),n("bbff")),o=n("2375"),d=n("5158"),u=n("be6c"),l=n("c365"),p=n("2fa3"),m={name:"Admin-Data",data:function(){return{products:[],editProduct:{_id:"",name:"",size:"",price:0},isEditing:!1,isProcessing:!1}},components:{Spinner:o["a"],AdminTab:c["a"],DataTab:d["a"]},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getProducts();case 3:n=e.sent,i=n.data,t.products=i.products,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),p["a"].fire({icon:"error",title:"無法取得商品資料"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},editInput:function(t){this.isEditing=!0;var e=this.products.find((function(e){return e._id===t}));this.editProduct=Object(a["a"])(Object(a["a"])({},this.editProduct),e)},updateProduct:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.editProduct.name&&t.editProduct.price){e.next=4;break}return p["a"].fire({icon:"error",title:"Price 和 Name為必填欄位"}),e.abrupt("return");case 4:if(t.isProcessing=!0,n={},!t.editProduct._id){e.next=12;break}return e.next=9,u["a"].products.update({id:t.editProduct._id,name:t.editProduct.name,size:t.editProduct.size,price:t.editProduct.price});case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,u["a"].products.create({name:t.editProduct.name,size:t.editProduct.size,price:t.editProduct.price});case 14:n=e.sent;case 15:if("success"===n.data.status){e.next=17;break}throw new Error(n.data.message);case 17:t.fetchData(),t.resetEditData(),p["a"].fire({icon:"success",title:"已更新資料"}),t.isEditing=!1,t.isProcessing=!1,e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](0),t.isProcessing=!1,p["a"].fire({icon:"error",title:"無法更新商品訊息，請稍後在試"});case 28:case"end":return e.stop()}}),e,null,[[0,24]])})))()},resetEditData:function(){this.editProduct={_id:"",name:"",size:"",price:0}},cancelEdit:function(){this.isEditing=!1,this.resetEditData()},deleteProduct:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.isProcessing=!0,!confirm("確定要刪除嗎？這個動作也會刪除相關紀錄")){e.next=10;break}return e.next=5,u["a"].products.delete({id:t.editProduct._id});case 5:if(n=e.sent,i=n.data,"success"===i.status){e.next=9;break}throw new Error(i.message);case 9:p["a"].fire({icon:"success",title:"已刪除資料"});case 10:t.isEditing=!1,t.isProcessing=!1,t.fetchData(),t.resetEditData(),e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](0),t.isProcessing=!1,p["a"].fire({icon:"error",title:"無法刪除商品，請稍後在試"});case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))()}}},f=m,v=(n("e754"),n("2877")),b=Object(v["a"])(f,i,r,!1,null,"08ef9fea",null);e["default"]=b.exports},bbff:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"link-wrapper d-flex"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data"}},[t._v("Data")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/charts"}},[t._v("Charts")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/users"}},[t._v("Users")])],1)])},r=[],a=(n("4680"),n("2877")),s={},c=Object(a["a"])(s,i,r,!1,null,"6e0c3b86",null);e["a"]=c.exports},be6c:function(t,e,n){"use strict";n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("25f0");var i=n("2fa3");e["a"]={ingredients:{update:function(t){var e=t.id,n=t.name,r=t.unit,a=t.unitName,s=t.unit2,c=t.unit2Name;return i["b"].put("/admin/ingredients/".concat(e),{name:n,unit:r,unitName:a,unit2:s,unit2Name:c})},create:function(t){var e=t.name,n=t.unit,r=t.unitName,a=t.unit2,s=t.unit2Name;return i["b"].post("/admin/ingredients",{name:e,unit:n,unitName:r,unit2:a,unit2Name:s})},delete:function(t){var e=t.id;return i["b"].delete("/admin/ingredients/".concat(e))}},products:{update:function(t){var e=t.id,n=t.name,r=t.size,a=t.price;return i["b"].put("/admin/products/".concat(e),{name:n,size:r,price:a})},create:function(t){var e=t.name,n=t.size,r=t.price;return i["b"].post("/admin/products",{name:e,size:n,price:r})},delete:function(t){var e=t.id;return i["b"].delete("/admin/products/".concat(e))}},compositions:{get:function(){return i["b"].get("/admin/compositions")},update:function(t){var e=t.id,n=t.quantity;return i["b"].put("/admin/compositions/".concat(e),{quantity:n})},create:function(t){var e=t.quantity,n=t.ingredientId,r=t.productId;return i["b"].post("/admin/compositions",{quantity:e,ingredientId:n,productId:r})},delete:function(t){var e=t.id;return i["b"].delete("/admin/compositions/".concat(e))}},getRecords:function(t){var e=t.year,n=t.month,r=t.ingredientId,a=t.authorId,s=new URLSearchParams({year:e,month:n,ingredientId:r,authorId:a});return i["b"].get("/admin/records?".concat(s.toString()))},users:{get:function(){return i["b"].get("/admin/users")},toggleAdmin:function(t){var e=t.id;return i["b"].put("/admin/users/".concat(e))},delete:function(t){var e=t.id;return i["b"].delete("/admin/users/".concat(e))},create:function(t){var e=t.formData;return i["b"].post("/admin/users",e)}}}},da87:function(t,e,n){},e754:function(t,e,n){"use strict";n("da87")}}]);
//# sourceMappingURL=chunk-464c5c43.cc90b194.js.map