{"version":3,"sources":["webpack:///./src/views/AdminComposition.vue?5459","webpack:///src/views/AdminComposition.vue","webpack:///./src/views/AdminComposition.vue?f563","webpack:///./src/views/AdminComposition.vue","webpack:///./src/components/DataTab.vue?f23f","webpack:///./src/components/AdminTab.vue?a403","webpack:///./src/components/DataTab.vue?8a95","webpack:///./src/components/DataTab.vue","webpack:///./src/views/AdminComposition.vue?a658","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/components/AdminTab.vue?f5eb","webpack:///./src/components/AdminTab.vue","webpack:///./src/apis/admin.js","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_l","product","key","_id","_s","name","attrs","on","$event","fetchComponents","editProduct","component","ingredientName","ingredientUnit","directives","rawName","value","expression","domProps","target","composing","$set","isProcessing","updateComposition","quantity","$$selectedVal","Array","prototype","filter","call","options","o","selected","map","val","_value","newIngredientId","multiple","ingredient","addIngredient","cancelEdit","_e","staticRenderFns","components","Spinner","AdminTab","DataTab","data","products","ingredients","compositions","isLoading","isEditing","created","fetchData","methods","resetEditData","i","ingredientId","unitName","find","newIngredient","icon","title","push","productId","script","$","$find","addToUnscopables","FIND","SKIPS_HOLES","proto","forced","callbackfn","arguments","length","undefined","update","id","unit","unit2","unit2Name","apiHelper","put","create","post","delete","size","price","get","getRecords","year","month","authorId","searchParams","URLSearchParams","toString","users","toggleAdmin","formData","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT"],"mappings":"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","file":"js/chunk-65b0893a.8f3ee93a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5\"},[_c('div',{staticClass:\"nav-wrapper d-flex\"},[_c('AdminTab'),_c('DataTab')],1),(_vm.isLoading)?_c('Spinner'):[_c('div',{staticClass:\"composition-main mt-3 d-flex align-items-start\"},[_c('div',{staticClass:\"products-wrapper\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"Select Product\")]),_vm._l((_vm.products),function(product){return _c('div',{key:product._id,staticClass:\"product-row\"},[_c('span',{staticClass:\"product-name\"},[_vm._v(_vm._s(product.name))]),_c('button',{staticClass:\"btn btn-info btn-sm ml-auto\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.fetchComponents(product._id)}}},[_vm._v(\" Edit \")])])})],2),(_vm.isEditing)?_c('div',{staticClass:\"ingredients-wrapper ml-4 text-center\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.editProduct.name))]),_vm._l((_vm.components),function(component){return _c('div',{key:component._id,staticClass:\"product-row d-flex justify-content-between\"},[_c('span',{staticClass:\"ingredient-name\"},[_vm._v(_vm._s(component.ingredientName)+\"(\"+_vm._s(component.ingredientUnit)+\")\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(component.quantity),expression:\"component.quantity\"}],staticClass:\"quantity form-control w-25\",attrs:{\"type\":\"number\"},domProps:{\"value\":(component.quantity)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(component, \"quantity\", $event.target.value)}}}),_c('button',{staticClass:\"btn btn-info btn-sm\",attrs:{\"type\":\"button\",\"disabled\":_vm.isProcessing},on:{\"click\":function($event){return _vm.updateComposition(component)}}},[_vm._v(\" \"+_vm._s(component.quantity != 0 ? \"save\" : \"delete\")+\" \")])])}),_c('div',{staticClass:\"buttons-wrapper d-flex p-3\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.newIngredientId),expression:\"newIngredientId\"}],staticClass:\"form-select\",attrs:{\"aria-label\":\"new ingredient\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.newIngredientId=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"\",\"selected\":\"\"}},[_vm._v(\"新增成份\")]),_vm._l((_vm.ingredients),function(ingredient){return _c('option',{key:ingredient._id,domProps:{\"value\":ingredient._id}},[_vm._v(\" \"+_vm._s(ingredient.name)+\" \")])})],2),_c('button',{staticClass:\"btn btn-info btn-sm ml-auto\",on:{\"click\":_vm.addIngredient}},[_vm._v(\" Add \")])]),_c('button',{staticClass:\"btn btn-warning btn-sm\",on:{\"click\":_vm.cancelEdit}},[_vm._v(\" Cancel \")])],2):_vm._e()])]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container py-5\">\r\n    <div class=\"nav-wrapper d-flex\">\r\n      <AdminTab />\r\n      <DataTab />\r\n    </div>\r\n    <Spinner v-if=\"isLoading\" />\r\n    <template v-else>\r\n      <div class=\"composition-main mt-3 d-flex align-items-start\">\r\n        <div class=\"products-wrapper\">\r\n          <div class=\"title\">Select Product</div>\r\n          <div\r\n            v-for=\"product in products\"\r\n            :key=\"product._id\"\r\n            class=\"product-row\"\r\n          >\r\n            <span class=\"product-name\">{{ product.name }}</span>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-info btn-sm ml-auto\"\r\n              @click=\"fetchComponents(product._id)\"\r\n            >\r\n              Edit\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div v-if=\"isEditing\" class=\"ingredients-wrapper ml-4 text-center\">\r\n          <div class=\"title\">{{ editProduct.name }}</div>\r\n          <div\r\n            v-for=\"component in components\"\r\n            :key=\"component._id\"\r\n            class=\"product-row d-flex justify-content-between\"\r\n          >\r\n            <span class=\"ingredient-name\"\r\n              >{{ component.ingredientName }}({{\r\n                component.ingredientUnit\r\n              }})</span\r\n            >\r\n            <input\r\n              v-model=\"component.quantity\"\r\n              type=\"number\"\r\n              class=\"quantity form-control w-25\"\r\n            />\r\n            <button\r\n              @click=\"updateComposition(component)\"\r\n              type=\"button\"\r\n              class=\"btn btn-info btn-sm\"\r\n              :disabled=\"isProcessing\"\r\n            >\r\n              {{ component.quantity != 0 ? \"save\" : \"delete\" }}\r\n            </button>\r\n          </div>\r\n          <div class=\"buttons-wrapper d-flex p-3\">\r\n            <select\r\n              v-model=\"newIngredientId\"\r\n              class=\"form-select\"\r\n              aria-label=\"new ingredient\"\r\n            >\r\n              <option value=\"\" selected>新增成份</option>\r\n              <option\r\n                v-for=\"ingredient in ingredients\"\r\n                :value=\"ingredient._id\"\r\n                :key=\"ingredient._id\"\r\n              >\r\n                {{ ingredient.name }}\r\n              </option>\r\n            </select>\r\n            <button @click=\"addIngredient\" class=\"btn btn-info btn-sm ml-auto\">\r\n              Add\r\n            </button>\r\n          </div>\r\n          <button @click=\"cancelEdit\" class=\"btn btn-warning btn-sm\">\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n</template>\r\n<script>\r\nimport AdminTab from \"../components/AdminTab.vue\";\r\nimport DataTab from \"../components/DataTab.vue\";\r\nimport recordsAPI from \"../apis/records\";\r\nimport Spinner from \"./../components/Spinner\";\r\nimport { Toast } from \"../utils/helpers\";\r\nimport adminAPI from \"../apis/admin\";\r\nexport default {\r\n  name: \"Admin-Data\",\r\n  components: {\r\n    Spinner,\r\n    AdminTab,\r\n    DataTab,\r\n  },\r\n  data() {\r\n    return {\r\n      products: [],\r\n      editProduct: {},\r\n      components: [],\r\n      ingredients: [],\r\n      newIngredientId: \"\",\r\n      compositions: [],\r\n      isLoading: true,\r\n      isEditing: false,\r\n      isProcessing: false,\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchData();\r\n  },\r\n  methods: {\r\n    async fetchData() {\r\n      try {\r\n        let response = {};\r\n        response = await recordsAPI.getProducts();\r\n        this.products = response.data.products;\r\n        response = await recordsAPI.getIngredients();\r\n        this.ingredients = response.data.ingredients;\r\n        this.fetchCompositions();\r\n        this.isLoading = false;\r\n      } catch (error) {\r\n        this.isLoading = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法載入後台資料\",\r\n        });\r\n      }\r\n    },\r\n    async fetchCompositions() {\r\n      try {\r\n        let response = {};\r\n        response = await adminAPI.compositions.get();\r\n        this.compositions = response.data.compositions;\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法載入成份資料\",\r\n        });\r\n      }\r\n    },\r\n    fetchComponents(id) {\r\n      this.resetEditData();\r\n      this.isEditing = true;\r\n      this.components = this.compositions.filter(\r\n        (composition) => id === composition.productId\r\n      );\r\n      this.components = this.components.map((i) => {\r\n        this.ingredients.forEach((ingredient) => {\r\n          if (ingredient._id === i.ingredientId) {\r\n            i.ingredientName = ingredient.name;\r\n            i.ingredientUnit = ingredient.unitName;\r\n          }\r\n        });\r\n        return i;\r\n      });\r\n      this.editProduct = this.products.find((p) => id === p._id);\r\n    },\r\n    cancelEdit() {\r\n      this.isEditing = false;\r\n      this.resetEditData();\r\n    },\r\n    resetEditData() {\r\n      this.editProduct = {};\r\n      this.components = [];\r\n    },\r\n    async updateComposition(component) {\r\n      try {\r\n        this.isProcessing = true;\r\n        let response = {};\r\n        //新成份 新增與刪除\r\n        if (!component._id) {\r\n          if (component.quantity == 0) {\r\n            this.components = this.components.filter(\r\n              (c) => c.ingredientId !== component.ingredientId\r\n            );\r\n            this.isProcessing = false;\r\n            return;\r\n          }\r\n          //新增\r\n          response = await adminAPI.compositions.create({\r\n            quantity: component.quantity,\r\n            ingredientId: component.ingredientId,\r\n            productId: component.productId,\r\n          });\r\n          this.cancelEdit();\r\n        } else {\r\n          //已存在元素更動\r\n          if (component.quantity == 0) {\r\n            if (confirm(\"確定要刪除嗎？這個動作也會刪除相關紀錄\")) {\r\n              response = await adminAPI.compositions.delete({\r\n                id: component._id,\r\n              });\r\n              this.components = this.components.filter(\r\n                (c) => c.ingredientId !== component.ingredientId\r\n              );\r\n            }\r\n          } else {\r\n            response = await adminAPI.compositions.update({\r\n              id: component._id,\r\n              quantity: component.quantity,\r\n            });\r\n          }\r\n        }\r\n\r\n        if (response.data.status !== \"success\") {\r\n          throw new Error(response.data.message);\r\n        }\r\n        Toast.fire({\r\n          icon: \"success\",\r\n          title: \"已更新資料\",\r\n        });\r\n        this.fetchCompositions();\r\n        this.isProcessing = false;\r\n      } catch (error) {\r\n        this.isProcessing = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法更新成份訊息，請稍後在試\",\r\n        });\r\n      }\r\n    },\r\n    addIngredient() {\r\n      const newIngredient = this.components.find(\r\n        (c) => c.ingredientId === this.newIngredientId\r\n      );\r\n      if (newIngredient) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"成份已存在在清單內\",\r\n        });\r\n        return;\r\n      }\r\n      const ingredient = this.ingredients.find(\r\n        (i) => i._id === this.newIngredientId\r\n      );\r\n      this.components.push({\r\n        _id: 0,\r\n        quantity: 0,\r\n        ingredientId: this.newIngredientId,\r\n        ingredientUnit: ingredient.unitName,\r\n        ingredientName: ingredient.name,\r\n        productId: this.editProduct._id,\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.ingredients-wrapper,\r\n.products-wrapper {\r\n  background-color: rgb(23, 162, 184, 0.2);\r\n  border-radius: 25px;\r\n  padding: 15px 10px;\r\n  border: 1px solid lightgray;\r\n  color: rgb(66, 66, 66);\r\n  width: 180px;\r\n}\r\n.ingredients-wrapper {\r\n  background-color: #ffffff;\r\n  width: 250px;\r\n}\r\n.title {\r\n  font-size: 20px;\r\n  font-weight: 700;\r\n  text-align: center;\r\n}\r\n.product-row {\r\n  display: flex;\r\n  align-items: center;\r\n  margin: 5px 0;\r\n  padding: 5px 5px;\r\n  border-bottom: 1px solid darkgray;\r\n}\r\n.product-row:last-child {\r\n  border-bottom: 0px;\r\n}\r\n\r\ninput::-webkit-outer-spin-button,\r\ninput::-webkit-inner-spin-button {\r\n  -webkit-appearance: none;\r\n  margin: 0;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminComposition.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminComposition.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminComposition.vue?vue&type=template&id=9b8c0378&scoped=true&\"\nimport script from \"./AdminComposition.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminComposition.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AdminComposition.vue?vue&type=style&index=0&id=9b8c0378&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9b8c0378\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataTab.vue?vue&type=style&index=0&id=19a7bc4c&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminTab.vue?vue&type=style&index=0&id=6e0c3b86&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"link-wrapper d-flex ml-3\"},[_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/data/ingredients\"}},[_vm._v(\"Ingredients\")]),_vm._v(\" | \"),_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/data/products\"}},[_vm._v(\"Products\")]),_vm._v(\" | \"),_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/data/composition\"}},[_vm._v(\"Conposition\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./DataTab.vue?vue&type=template&id=19a7bc4c&scoped=true&\"\nvar script = {}\nimport style0 from \"./DataTab.vue?vue&type=style&index=0&id=19a7bc4c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"19a7bc4c\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminComposition.vue?vue&type=style&index=0&id=9b8c0378&scoped=true&lang=css&\"","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"link-wrapper d-flex\"},[_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/data\"}},[_vm._v(\"Data\")]),_vm._v(\" | \"),_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/charts\"}},[_vm._v(\"Charts\")]),_vm._v(\" | \"),_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/users\"}},[_vm._v(\"Users\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AdminTab.vue?vue&type=template&id=6e0c3b86&scoped=true&\"\nvar script = {}\nimport style0 from \"./AdminTab.vue?vue&type=style&index=0&id=6e0c3b86&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6e0c3b86\",\n  null\n  \n)\n\nexport default component.exports","import { apiHelper } from './../utils/helpers'\r\n\r\nexport default {\r\n  ingredients: {\r\n    update({ id, name, unit, unitName, unit2, unit2Name }) {\r\n      return apiHelper.put(`/admin/ingredients/${id}`, { name, unit, unitName, unit2, unit2Name })\r\n    },\r\n    create({ name, unit, unitName, unit2, unit2Name }) {\r\n      return apiHelper.post(`/admin/ingredients`, { name, unit, unitName, unit2, unit2Name })\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/ingredients/${id}`)\r\n    }\r\n  },\r\n  products: {\r\n    update({ id, name, size, price }) {\r\n      return apiHelper.put(`/admin/products/${id}`, { name, size, price })\r\n    },\r\n    create({ name, size, price }) {\r\n      return apiHelper.post(`/admin/products`, { name, size, price })\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/products/${id}`)\r\n    }\r\n  },\r\n  compositions: {\r\n    get() {\r\n      return apiHelper.get(`/admin/compositions`)\r\n    },\r\n    update({ id, quantity }) {\r\n      return apiHelper.put(`/admin/compositions/${id}`, { quantity })\r\n    },\r\n    create({ quantity, ingredientId, productId }) {\r\n      return apiHelper.post(`/admin/compositions`, { quantity, ingredientId, productId })\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/compositions/${id}`)\r\n    }\r\n  },\r\n  getRecords({ year, month, ingredientId, authorId }) {\r\n    const searchParams = new URLSearchParams({ year, month, ingredientId, authorId })\r\n    return apiHelper.get(`/admin/records?${searchParams.toString()}`)\r\n\r\n  },\r\n  users: {\r\n    get() {\r\n      return apiHelper.get(`/admin/users`)\r\n    },\r\n    toggleAdmin({ id }) {\r\n      return apiHelper.put(`/admin/users/${id}`)\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/users/${id}`)\r\n    },\r\n    create({ formData }) {\r\n      return apiHelper.post(`/admin/users`, formData)\r\n    }\r\n  }\r\n\r\n}","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}