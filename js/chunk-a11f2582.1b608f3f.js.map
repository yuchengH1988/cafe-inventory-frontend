{"version":3,"sources":["webpack:///./src/components/AdminTab.vue?a403","webpack:///./src/views/AdminCharts.vue?5ec7","webpack:///./src/components/AdminTab.vue?f5eb","webpack:///./src/components/AdminTab.vue","webpack:///./src/apis/admin.js","webpack:///./src/views/AdminCharts.vue?d50c","webpack:///src/views/AdminCharts.vue","webpack:///./src/views/AdminCharts.vue?df37","webpack:///./src/views/AdminCharts.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","staticRenderFns","script","component","ingredients","update","id","name","unit","unitName","unit2","unit2Name","apiHelper","put","create","post","delete","products","size","price","compositions","get","quantity","ingredientId","productId","getRecords","year","month","authorId","searchParams","URLSearchParams","toString","users","toggleAdmin","formData","chartsData","data","length","_e","directives","rawName","value","expression","on","$event","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","userId","multiple","fetchData","_l","u","key","_id","domProps","_s","m","records","i","unitSet","ingredient","staticStyle","statisticNumbers","actualUsed","Math","round","estimateUsed","errorUsed","components","AdminTab","Spinner","BarCharts","isLoading","years","months","methods","createLabels","labels","push","createData","dateId","dateArray","record","statisticalCalculator","numUnit2","number","toFixed"],"mappings":"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","file":"js/chunk-a11f2582.1b608f3f.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminTab.vue?vue&type=style&index=0&id=6e0c3b86&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminCharts.vue?vue&type=style&index=0&id=5fec1f0a&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"link-wrapper d-flex\"},[_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/data\"}},[_vm._v(\"Data\")]),_vm._v(\" | \"),_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/charts\"}},[_vm._v(\"Charts\")]),_vm._v(\" | \"),_c('router-link',{staticClass:\"nav-link\",attrs:{\"to\":\"/admin/users\"}},[_vm._v(\"Users\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AdminTab.vue?vue&type=template&id=6e0c3b86&scoped=true&\"\nvar script = {}\nimport style0 from \"./AdminTab.vue?vue&type=style&index=0&id=6e0c3b86&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6e0c3b86\",\n  null\n  \n)\n\nexport default component.exports","import { apiHelper } from './../utils/helpers'\r\n\r\nexport default {\r\n  ingredients: {\r\n    update({ id, name, unit, unitName, unit2, unit2Name }) {\r\n      return apiHelper.put(`/admin/ingredients/${id}`, { name, unit, unitName, unit2, unit2Name })\r\n    },\r\n    create({ name, unit, unitName, unit2, unit2Name }) {\r\n      return apiHelper.post(`/admin/ingredients`, { name, unit, unitName, unit2, unit2Name })\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/ingredients/${id}`)\r\n    }\r\n  },\r\n  products: {\r\n    update({ id, name, size, price }) {\r\n      return apiHelper.put(`/admin/products/${id}`, { name, size, price })\r\n    },\r\n    create({ name, size, price }) {\r\n      return apiHelper.post(`/admin/products`, { name, size, price })\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/products/${id}`)\r\n    }\r\n  },\r\n  compositions: {\r\n    get() {\r\n      return apiHelper.get(`/admin/compositions`)\r\n    },\r\n    update({ id, quantity }) {\r\n      return apiHelper.put(`/admin/compositions/${id}`, { quantity })\r\n    },\r\n    create({ quantity, ingredientId, productId }) {\r\n      return apiHelper.post(`/admin/compositions`, { quantity, ingredientId, productId })\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/compositions/${id}`)\r\n    }\r\n  },\r\n  getRecords({ year, month, ingredientId, authorId }) {\r\n    const searchParams = new URLSearchParams({ year, month, ingredientId, authorId })\r\n    return apiHelper.get(`/admin/records?${searchParams.toString()}`)\r\n\r\n  },\r\n  users: {\r\n    get() {\r\n      return apiHelper.get(`/admin/users`)\r\n    },\r\n    toggleAdmin({ id }) {\r\n      return apiHelper.put(`/admin/users/${id}`)\r\n    },\r\n    delete({ id }) {\r\n      return apiHelper.delete(`/admin/users/${id}`)\r\n    },\r\n    create({ formData }) {\r\n      return apiHelper.post(`/admin/users`, formData)\r\n    }\r\n  }\r\n\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5\"},[_c('AdminTab'),(_vm.isLoading)?_c('Spinner'):[(_vm.chartsData.data.length > 1)?_c('BarCharts',{attrs:{\"initData\":_vm.chartsData}}):_vm._e(),_c('div',{staticClass:\"filter-wrapper d-flex justify-content-center mt-3\"},[_c('span',[_vm._v(\"店家\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.userId),expression:\"userId\"}],staticClass:\"form-select form-select-sm mx-2\",attrs:{\"aria-label\":\".form-select-sm example\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.userId=$event.target.multiple ? $$selectedVal : $$selectedVal[0]},_vm.fetchData]}},_vm._l((_vm.users),function(u){return _c('option',{key:u._id,domProps:{\"value\":u._id}},[_vm._v(\" \"+_vm._s(u.name)+\" \")])}),0),_c('span',[_vm._v(\"月份：\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.month),expression:\"month\"}],staticClass:\"form-select form-select-sm mx-2\",attrs:{\"aria-label\":\".form-select-sm example\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.month=$event.target.multiple ? $$selectedVal : $$selectedVal[0]},_vm.fetchData]}},_vm._l((_vm.months),function(m){return _c('option',{key:m.value,domProps:{\"value\":m.value}},[_vm._v(\" \"+_vm._s(m.name)+\" \")])}),0),_c('span',{staticClass:\"mx-2\"},[_vm._v(\"營業天數：\"+_vm._s(_vm.records.length)+\"天\")]),_c('span',{staticClass:\"ml-4\"},[_vm._v(\"物料種類：\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.ingredientId),expression:\"ingredientId\"}],staticClass:\"form-select form-select-sm mx-2\",attrs:{\"aria-label\":\".form-select-sm example\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.ingredientId=$event.target.multiple ? $$selectedVal : $$selectedVal[0]},_vm.fetchData]}},_vm._l((_vm.ingredients),function(i){return _c('option',{key:i._id,domProps:{\"value\":i._id}},[_vm._v(\" \"+_vm._s(i.name)+\" \")])}),0),_c('span',{staticClass:\"ml-4\"},[_vm._v(\"單位：\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.unitSet),expression:\"unitSet\"}],staticClass:\"form-select form-select-sm mx-2\",attrs:{\"aria-label\":\".form-select-sm example\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.unitSet=$event.target.multiple ? $$selectedVal : $$selectedVal[0]},_vm.fetchData]}},[_c('option',{domProps:{\"value\":_vm.ingredient.unit}},[_vm._v(\" \"+_vm._s(_vm.ingredient.unitName)+\" \")]),_c('option',{domProps:{\"value\":_vm.ingredient.unit2}},[_vm._v(\" \"+_vm._s(_vm.ingredient.unit2Name)+\" \")])])]),_c('div',{staticClass:\"result-form mt-3 p-3 w-50\",staticStyle:{\"font-size\":\"15px\"}},[_c('table',{staticClass:\"table form-group\"},[_c('thead',[_c('tr',{staticClass:\"table-info\"},[_c('th',[_vm._v(_vm._s(_vm.ingredient.name)+\"分析表\")]),_c('th',[_vm._v(\"月總量\")]),_c('th',[_vm._v(\"日平均\")])])]),_c('tbody',[_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"實際量\")]),_c('td',[_vm._v(_vm._s(_vm.statisticNumbers.actualUsed))]),_c('td',[_vm._v(\" \"+_vm._s(Math.round(_vm.statisticNumbers.actualUsed / _vm.records.length))+\" \")])]),_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"應用量\")]),_c('td',[_vm._v(_vm._s(_vm.statisticNumbers.estimateUsed))]),_c('td',[_vm._v(\" \"+_vm._s(Math.round(_vm.statisticNumbers.estimateUsed / _vm.records.length))+\" \")])]),_c('tr',[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(\"誤差量\")]),_c('td',[_vm._v(_vm._s(_vm.statisticNumbers.errorUsed))]),_c('td',[_vm._v(\" \"+_vm._s(Math.round(_vm.statisticNumbers.errorUsed / _vm.records.length))+\" \")])])])])])]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container py-5\">\r\n    <AdminTab />\r\n    <Spinner v-if=\"isLoading\" />\r\n    <template v-else>\r\n      <BarCharts v-if=\"chartsData.data.length > 1\" :initData=\"chartsData\" />\r\n      <div class=\"filter-wrapper d-flex justify-content-center mt-3\">\r\n        <span>店家</span>\r\n        <select\r\n          class=\"form-select form-select-sm mx-2\"\r\n          aria-label=\".form-select-sm example\"\r\n          v-model=\"userId\"\r\n          @change=\"fetchData\"\r\n        >\r\n          <option v-for=\"u in users\" :key=\"u._id\" :value=\"u._id\">\r\n            {{ u.name }}\r\n          </option>\r\n        </select>\r\n        <span>月份：</span>\r\n        <select\r\n          class=\"form-select form-select-sm mx-2\"\r\n          aria-label=\".form-select-sm example\"\r\n          v-model=\"month\"\r\n          @change=\"fetchData\"\r\n        >\r\n          <option v-for=\"m in months\" :key=\"m.value\" :value=\"m.value\">\r\n            {{ m.name }}\r\n          </option>\r\n        </select>\r\n        <span class=\"mx-2\">營業天數：{{ records.length }}天</span>\r\n        <span class=\"ml-4\">物料種類：</span>\r\n        <select\r\n          class=\"form-select form-select-sm mx-2\"\r\n          aria-label=\".form-select-sm example\"\r\n          v-model=\"ingredientId\"\r\n          @change=\"fetchData\"\r\n        >\r\n          <option v-for=\"i in ingredients\" :key=\"i._id\" :value=\"i._id\">\r\n            {{ i.name }}\r\n          </option>\r\n        </select>\r\n        <span class=\"ml-4\">單位：</span>\r\n        <select\r\n          class=\"form-select form-select-sm mx-2\"\r\n          aria-label=\".form-select-sm example\"\r\n          v-model=\"unitSet\"\r\n          @change=\"fetchData\"\r\n        >\r\n          <option :value=\"ingredient.unit\">\r\n            {{ ingredient.unitName }}\r\n          </option>\r\n          <option :value=\"ingredient.unit2\">\r\n            {{ ingredient.unit2Name }}\r\n          </option>\r\n        </select>\r\n      </div>\r\n      <div class=\"result-form mt-3 p-3 w-50\" style=\"font-size: 15px\">\r\n        <table class=\"table form-group\">\r\n          <thead>\r\n            <tr class=\"table-info\">\r\n              <th>{{ ingredient.name }}分析表</th>\r\n              <th>月總量</th>\r\n              <th>日平均</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <th scope=\"row\">實際量</th>\r\n              <td>{{ statisticNumbers.actualUsed }}</td>\r\n              <td>\r\n                {{ Math.round(statisticNumbers.actualUsed / records.length) }}\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <th scope=\"row\">應用量</th>\r\n              <td>{{ statisticNumbers.estimateUsed }}</td>\r\n              <td>\r\n                {{ Math.round(statisticNumbers.estimateUsed / records.length) }}\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <th scope=\"row\">誤差量</th>\r\n              <td>{{ statisticNumbers.errorUsed }}</td>\r\n              <td>\r\n                {{ Math.round(statisticNumbers.errorUsed / records.length) }}\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </template>\r\n  </div>\r\n</template>\r\n<script>\r\nimport adminAPI from \"./../apis/admin\";\r\nimport recordsAPI from \"../apis/records\";\r\nimport { Toast } from \"./../utils/helpers\";\r\nimport moment from \"moment\";\r\nimport Spinner from \"./../components/Spinner\";\r\nimport BarCharts from \"./../components/BarCharts\";\r\nimport AdminTab from \"../components/AdminTab.vue\";\r\nexport default {\r\n  name: \"Admin-Charts\",\r\n  components: {\r\n    AdminTab,\r\n    Spinner,\r\n    BarCharts,\r\n  },\r\n  data() {\r\n    return {\r\n      ingredients: [],\r\n      ingredient: {},\r\n      isLoading: true,\r\n      year: \"\",\r\n      month: \"\",\r\n      years: [],\r\n      months: [],\r\n      ingredientId: \"\",\r\n      chartsData: {},\r\n      records: [],\r\n      statisticNumbers: {},\r\n      unitSet: 1,\r\n      users: [],\r\n      userId: \"\",\r\n    };\r\n  },\r\n  async created() {\r\n    this.month = moment().format(\"MM\");\r\n    this.year = moment().format(\"YYYY\");\r\n    this.years = [\r\n      moment().format(\"YYYY\"),\r\n      moment().add(-1, \"y\").format(\"YYYY\"),\r\n    ];\r\n    for (let i = 1; i <= 12; i++) {\r\n      let m = i;\r\n      if (i < 10) {\r\n        m = \"0\" + i;\r\n      } else {\r\n        m = m.toString();\r\n      }\r\n      this.months.push({ value: m, name: i + \"月\" });\r\n    }\r\n    await this.fetchUsers();\r\n    await this.fetchIngredients();\r\n    await this.fetchData();\r\n  },\r\n  methods: {\r\n    async fetchData() {\r\n      try {\r\n        this.chartsData.data = [];\r\n        if (!this.ingredientId) {\r\n          this.ingredientId = this.ingredients[0]._id;\r\n        }\r\n        this.ingredient = this.ingredients.find(\r\n          (i) => i._id === this.ingredientId\r\n        );\r\n        const { data } = await adminAPI.getRecords({\r\n          year: this.year,\r\n          month: this.month,\r\n          ingredientId: this.ingredientId,\r\n          authorId: this.userId,\r\n        });\r\n        this.records = data.records;\r\n        //製作Lables\r\n        this.createLabels();\r\n        // 製作Data陣列\r\n        this.createData();\r\n        this.statisticalCalculator();\r\n        if (this.unitSet !== 1) {\r\n          this.chartsData.label = `誤差值 (${this.ingredient.unit2Name})`;\r\n        } else {\r\n          this.chartsData.label = `誤差值 (${this.ingredient.unitName})`;\r\n        }\r\n        this.chartsData.title = `${this.ingredient.name}   ${this.year}/${this.month}`;\r\n\r\n        this.isLoading = false;\r\n      } catch (error) {\r\n        this.isLoading = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法載入資料\",\r\n        });\r\n      }\r\n    },\r\n    createLabels() {\r\n      //日期標籤生產器\r\n      this.chartsData.labels = [];\r\n      let days = new Date(this.year, this.month, 0).getDate();\r\n      let firstDate = new Date(this.year, this.month, 1);\r\n      for (let i = -days; i < 0; i++) {\r\n        this.chartsData.labels.push(\r\n          moment(firstDate).add(i, \"d\").format(\"MM/DD\")\r\n        );\r\n      }\r\n    },\r\n    createData() {\r\n      this.chartsData.data = [];\r\n      const monthOfDays = this.chartsData.labels.length;\r\n      let dateArray = [];\r\n      for (let i = 1; i <= monthOfDays; i++) {\r\n        let dateId = this.year + this.month;\r\n        if (i < 10) {\r\n          dateId += \"0\" + i;\r\n        } else {\r\n          dateId += i;\r\n        }\r\n        dateArray.push(dateId);\r\n      }\r\n      for (let i = 0; i < dateArray.length; i++) {\r\n        this.chartsData.data.push(0);\r\n        this.records.forEach((record) => {\r\n          if (record.dateId === dateArray[i]) {\r\n            this.chartsData.data[i] = record.actualUsed - record.estimateUsed;\r\n            if (this.unitSet !== 1) {\r\n              this.chartsData.data[i] = this.numUnit2(this.chartsData.data[i]);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    },\r\n    async fetchUsers() {\r\n      try {\r\n        const response = await adminAPI.users.get();\r\n        this.users = response.data.users;\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法讀取用者資訊，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n    async fetchIngredients() {\r\n      try {\r\n        const response = await recordsAPI.getIngredients({});\r\n        this.ingredients = response.data.ingredients;\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法讀取物料資訊，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n    statisticalCalculator() {\r\n      this.statisticNumbers.actualUsed = 0;\r\n      this.statisticNumbers.estimateUsed = 0;\r\n      for (let record of this.records) {\r\n        this.statisticNumbers.actualUsed += record.actualUsed;\r\n        this.statisticNumbers.estimateUsed += record.estimateUsed;\r\n      }\r\n      this.statisticNumbers.errorUsed =\r\n        this.statisticNumbers.actualUsed - this.statisticNumbers.estimateUsed;\r\n      if (this.unitSet !== 1) {\r\n        this.statisticNumbers.actualUsed = this.numUnit2(\r\n          this.statisticNumbers.actualUsed\r\n        );\r\n        this.statisticNumbers.estimateUsed = this.numUnit2(\r\n          this.statisticNumbers.estimateUsed\r\n        );\r\n        this.statisticNumbers.errorUsed = this.numUnit2(\r\n          this.statisticNumbers.errorUsed\r\n        );\r\n      }\r\n    },\r\n    numUnit2(number) {\r\n      number = (number / this.unitSet).toFixed(2);\r\n      return number;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.container {\r\n  height: 100vh;\r\n  overflow-y: scroll;\r\n}\r\n\r\n.container::-webkit-scrollbar {\r\n  display: none;\r\n}\r\nth,\r\ntd {\r\n  font-size: 14px;\r\n  padding: 10px;\r\n  text-align: center;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminCharts.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminCharts.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminCharts.vue?vue&type=template&id=5fec1f0a&scoped=true&\"\nimport script from \"./AdminCharts.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminCharts.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AdminCharts.vue?vue&type=style&index=0&id=5fec1f0a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5fec1f0a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}