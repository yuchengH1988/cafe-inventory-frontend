(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-309015ad"],{"0247":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container py-5"},[n("div",{staticClass:"nav-wrapper d-flex"},[n("AdminTab"),n("DataTab")],1),t.isLoading?n("Spinner"):[n("div",{staticClass:"ingredients-main mt-3 d-flex align-items-start"},[n("div",{staticClass:"ingredients-wrapper"},[n("span",{staticClass:"ingredient-title"},[t._v("Ingredient List")]),t._l(t.ingredients,(function(e){return n("div",{key:e.id,staticClass:"ingredient-list d-flex align-items-center"},[n("span",[t._v(t._s(e.name))]),n("button",{staticClass:"btn btn-info btn-sm ml-auto",attrs:{type:"button"},on:{click:function(n){return t.editInput(e._id)}}},[t._v(" Edit ")])])})),n("button",{staticClass:"btn btn-info btn-sm mx-5 mt-3",attrs:{type:"button"},on:{click:function(e){t.resetEditData(),t.editInput()}}},[t._v(" New ")])],2),t.isEditing?n("div",{staticClass:"ingredient-form ml-5 card"},[n("span",{staticClass:"form-title mb-2"},[t._v(t._s(t.editIngredient.name?t.editIngredient.name:"New Ingredient"))]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("名稱")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editIngredient.name,expression:"editIngredient.name"}],staticClass:"form-control form-input",attrs:{type:"text"},domProps:{value:t.editIngredient.name},on:{input:function(e){e.target.composing||t.$set(t.editIngredient,"name",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("基本單位")]),n("input",{staticClass:"form-control form-input",attrs:{disabled:"",type:"number",value:"1"}})]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("基本單位名稱")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editIngredient.unitName,expression:"editIngredient.unitName"}],staticClass:"form-control form-input",attrs:{type:"text"},domProps:{value:t.editIngredient.unitName},on:{input:function(e){e.target.composing||t.$set(t.editIngredient,"unitName",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("大單位")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editIngredient.unit2,expression:"editIngredient.unit2"}],staticClass:"form-control form-input",attrs:{type:"number"},domProps:{value:t.editIngredient.unit2},on:{input:function(e){e.target.composing||t.$set(t.editIngredient,"unit2",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper"},[n("span",{staticClass:"form-key text-center"},[t._v("大單位名稱")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.editIngredient.unit2Name,expression:"editIngredient.unit2Name"}],staticClass:"form-control form-input",attrs:{type:"text"},domProps:{value:t.editIngredient.unit2Name},on:{input:function(e){e.target.composing||t.$set(t.editIngredient,"unit2Name",e.target.value)}}})]),n("div",{staticClass:"form-row-wrapper justify-content-between"},[n("button",{staticClass:"btn btn-info",attrs:{disabled:t.isProcessing},on:{click:t.updateIngredient}},[t._v(" "+t._s(t.isProcessing?"Processing":"Save")+" ")]),n("button",{staticClass:"btn btn-warning",on:{click:t.cancelEdit}},[t._v("Cancel")]),t.editIngredient._id?n("button",{staticClass:"btn btn-danger",attrs:{disabled:t.isProcessing},on:{click:t.deleteIngredient}},[t._v(" "+t._s(t.isProcessing?"Processing":"Delete")+" ")]):t._e()])]):t._e()])]],2)},a=[],r=n("5530"),s=n("1da1"),d=(n("7db0"),n("b0c0"),n("96cf"),n("bbff")),c=n("5158"),o=n("be6c"),u=n("c365"),m=n("2fa3"),l=n("2375"),g={name:"Admin-Data",data:function(){return{ingredients:[],editIngredient:{_id:"",name:"",unit:1,unitName:"",unit2:0,unit2Name:""},isEditing:!1,isProcessing:!1}},components:{Spinner:l["a"],AdminTab:d["a"],DataTab:c["a"]},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u["a"].getIngredients();case 3:n=e.sent,i=n.data,t.ingredients=i.ingredients,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),m["a"].fire({icon:"error",title:"無法取得原料資料"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},editInput:function(t){this.isEditing=!0;var e=this.ingredients.find((function(e){return e._id===t}));this.editIngredient=Object(r["a"])(Object(r["a"])({},this.editIngredient),e)},updateIngredient:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.editIngredient.name&&t.editIngredient.unit&&t.editIngredient.unitName){e.next=4;break}return m["a"].fire({icon:"error",title:"請填上所有欄位。"}),e.abrupt("return");case 4:if(t.isProcessing=!0,n={},!t.editIngredient._id){e.next=12;break}return e.next=9,o["a"].ingredients.update({id:t.editIngredient._id,name:t.editIngredient.name,unit:t.editIngredient.unit,unitName:t.editIngredient.unitName,unit2:t.editIngredient.unit2,unit2Name:t.editIngredient.unit2Name});case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,o["a"].ingredients.create({name:t.editIngredient.name,unit:t.editIngredient.unit,unitName:t.editIngredient.unitName,unit2:t.editIngredient.unit2,unit2Name:t.editIngredient.unit2Name});case 14:n=e.sent;case 15:if("success"===n.data.status){e.next=17;break}throw new Error(n.data.message);case 17:t.fetchData(),t.resetEditData(),m["a"].fire({icon:"success",title:"已更新資料"}),t.isEditing=!1,t.isProcessing=!1,e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](0),t.isProcessing=!1,m["a"].fire({icon:"error",title:"無法更新原料訊息，請稍後在試"});case 28:case"end":return e.stop()}}),e,null,[[0,24]])})))()},resetEditData:function(){this.editIngredient={_id:"",name:"",unit:1,unitName:"",unit2:0,unit2Name:""}},cancelEdit:function(){this.isEditing=!1,this.resetEditData()},deleteIngredient:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.isProcessing=!0,!confirm("確定要刪除嗎？這個動作也會刪除相關紀錄")){e.next=10;break}return e.next=5,o["a"].ingredients.delete({id:t.editIngredient._id});case 5:if(n=e.sent,i=n.data,"success"===i.status){e.next=9;break}throw new Error(i.message);case 9:m["a"].fire({icon:"success",title:"已刪除資料"});case 10:t.isEditing=!1,t.isProcessing=!1,t.fetchData(),t.resetEditData(),e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](0),t.isProcessing=!1,m["a"].fire({icon:"error",title:"無法刪除原料，請稍後在試"});case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))()}}},p=g,f=(n("1a59"),n("2877")),v=Object(f["a"])(p,i,a,!1,null,"8722bb5e",null);e["default"]=v.exports},"1a59":function(t,e,n){"use strict";n("d305")},"1c7b":function(t,e,n){"use strict";n("6745")},4680:function(t,e,n){"use strict";n("a764")},5158:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"link-wrapper d-flex ml-3"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data/ingredients"}},[t._v("Ingredients")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data/products"}},[t._v("Products")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data/composition"}},[t._v("Conposition")])],1)])},a=[],r=(n("1c7b"),n("2877")),s={},d=Object(r["a"])(s,i,a,!1,null,"19a7bc4c",null);e["a"]=d.exports},6745:function(t,e,n){},"7db0":function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").find,r=n("44d2"),s="find",d=!0;s in[]&&Array(1)[s]((function(){d=!1})),i({target:"Array",proto:!0,forced:d},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r(s)},a764:function(t,e,n){},bbff:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"link-wrapper d-flex"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/data"}},[t._v("Data")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/charts"}},[t._v("Charts")]),t._v(" | "),n("router-link",{staticClass:"nav-link",attrs:{to:"/admin/users"}},[t._v("Users")])],1)])},a=[],r=(n("4680"),n("2877")),s={},d=Object(r["a"])(s,i,a,!1,null,"6e0c3b86",null);e["a"]=d.exports},be6c:function(t,e,n){"use strict";n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("25f0");var i=n("2fa3");e["a"]={ingredients:{update:function(t){var e=t.id,n=t.name,a=t.unit,r=t.unitName,s=t.unit2,d=t.unit2Name;return i["b"].put("/admin/ingredients/".concat(e),{name:n,unit:a,unitName:r,unit2:s,unit2Name:d})},create:function(t){var e=t.name,n=t.unit,a=t.unitName,r=t.unit2,s=t.unit2Name;return i["b"].post("/admin/ingredients",{name:e,unit:n,unitName:a,unit2:r,unit2Name:s})},delete:function(t){var e=t.id;return i["b"].delete("/admin/ingredients/".concat(e))}},products:{update:function(t){var e=t.id,n=t.name,a=t.size,r=t.price;return i["b"].put("/admin/products/".concat(e),{name:n,size:a,price:r})},create:function(t){var e=t.name,n=t.size,a=t.price;return i["b"].post("/admin/products",{name:e,size:n,price:a})},delete:function(t){var e=t.id;return i["b"].delete("/admin/products/".concat(e))}},compositions:{get:function(){return i["b"].get("/admin/compositions")},update:function(t){var e=t.id,n=t.quantity;return i["b"].put("/admin/compositions/".concat(e),{quantity:n})},create:function(t){var e=t.quantity,n=t.ingredientId,a=t.productId;return i["b"].post("/admin/compositions",{quantity:e,ingredientId:n,productId:a})},delete:function(t){var e=t.id;return i["b"].delete("/admin/compositions/".concat(e))}},getRecords:function(t){var e=t.year,n=t.month,a=t.ingredientId,r=t.authorId,s=new URLSearchParams({year:e,month:n,ingredientId:a,authorId:r});return i["b"].get("/admin/records?".concat(s.toString()))},users:{get:function(){return i["b"].get("/admin/users")},toggleAdmin:function(t){var e=t.id;return i["b"].put("/admin/users/".concat(e))},delete:function(t){var e=t.id;return i["b"].delete("/admin/users/".concat(e))},create:function(t){var e=t.formData;return i["b"].post("/admin/users",e)}}}},d305:function(t,e,n){}}]);
//# sourceMappingURL=chunk-309015ad.a98246b9.js.map